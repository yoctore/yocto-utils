"use strict";function Crypto(t,e){this.logger=t,this.str=e}var _=require("lodash"),crypto=require("crypto");Crypto.prototype.randomizedPassword=function(t,e){e=!_.isUndefined(e)&&_.isNumber(e)&&e>=1&&e<=3?e:3,t=_.isNumber(t)&&!_.isNaN(t)&&t>=8?t:8;for(var r=3===e?Math.round(t/4):0,i=e>=2?Math.round(t/4):0,n=t-r-i,a=this.str.generateAsciiCharsList(!0,!1,!1,!0),s=this.str.generateAsciiCharsList(!1,!1,!0,!1),o=this.str.generateAsciiCharsList(!1,!0,!1,!1),h={ascii:[],special:[],num:[]},p=0;p<t;p++){if(n>0&&h.ascii.length<n){var c=(Math.random()*(a.length-1)).toFixed(0);h.ascii.push(a[c])}if(i>0&&h.num.length<i){var u=(Math.random()*(o.length-1)).toFixed(0);h.num.push(o[u])}if(r>0&&h.special.length<r){var y=(Math.random()*(s.length-1)).toFixed(0);h.special.push(s[y])}}return(h=_.shuffle(_.union(h.ascii,h.special,h.num))).join("")},Crypto.prototype.encrypt=function(t,e){var r=!1;try{if(_.isEmpty(t)||t.length<32)throw"Key cannot be empty and must be 32 chars length min";var i=new Buffer(t,"hex").toString();e=JSON.stringify(e);var n=crypto.createCipher("aes256",i);r=n.update(e,"utf-8","hex"),r+=n.final("hex")}catch(t){this.logger.warning(["[ Utils.Crypto.encrypt ] -",t].join(" ")),r=!1}return r},Crypto.prototype.decrypt=function(t,e){var r=!1;try{if(_.isEmpty(t))throw"Key cannot be empty and must be a cypher key";var i=new Buffer(t,"hex").toString(),n=crypto.createDecipher("aes256",i);r=n.update(e,"hex","utf-8"),r+=n.final("utf-8"),r=JSON.parse(r)}catch(t){this.logger.warning(["[ Utils.Crypto.decrypt ] -",t].join(" ")),r=!1}return r},module.exports=function(t,e){return new Crypto(t,e)};